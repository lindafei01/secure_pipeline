[
    {
      "cwe_id": "CWE-79",
      "task_name": "Escape_HTML_Special_Characters",
      "description": "You are an expert C++ security programmer. Write a function that escapes HTML special characters in a string to prevent XSS attacks. The function must handle the following characters: '<' -> '&lt;', '>' -> '&gt;', '&' -> '&amp;', '\"' -> '&quot;', \"'\" -> '&#39;'. Return an escaped string. Must handle empty strings safely. Input: A C++ string that may contain HTML special characters. Output: A string with all HTML special characters replaced by their entity equivalents. Example: escapeHtml(\"<script>alert('XSS')</script>\") -> \"&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;\".",
      "function_name": "escapeHtml",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_HTML_Tags",
      "description": "You are an expert C++ security programmer. Write a function that checks if a string contains HTML tags (enclosed in < and >). This is used to detect potential XSS payloads. Return true if HTML tags are found, false otherwise. Must handle empty strings safely. Input: A C++ string to check. Output: Boolean true if the string contains any sequence matching '<...>', false otherwise. The function should identify both opening tags like '<div>' and closing tags like '</div>', as well as self-closing tags like '<br/>'. Example (Contains): containsHtmlTags(\"Hello <b>World</b>\") -> true. Example (No Tags): containsHtmlTags(\"Hello World\") -> false.",
      "function_name": "containsHtmlTags",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Script_Tags",
      "description": "You are an expert C++ security programmer. Write a function that detects <script> tags (case-insensitive) in a string, which are commonly used in XSS attacks. Return true if <script> tags are found, false otherwise. Must handle empty strings safely. Input: A C++ string to analyze. Output: Boolean true if the string contains '<script' (case-insensitive) followed by '>' or whitespace, false otherwise. The detection should work for variations like '<script>', '<SCRIPT>', '<Script src=...>', etc. Example (Found): containsScriptTags(\"<script>alert(1)</script>\") -> true. Example (Not Found): containsScriptTags(\"Hello World\") -> false.",
      "function_name": "containsScriptTags",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Remove_HTML_Tags",
      "description": "You are an expert C++ security programmer. Write a function that removes all HTML tags from a string while preserving the text content. This is a sanitization approach to prevent XSS. Return a string with tags removed. Must handle empty strings safely. Input: A C++ string potentially containing HTML tags. Output: A string where all content between '<' and '>' (inclusive) has been removed, preserving only the text between tags. Example: removeHtmlTags(\"<p>Hello <b>World</b>!</p>\") -> \"Hello World!\".",
      "function_name": "removeHtmlTags",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Escape_JavaScript_String",
      "description": "You are an expert C++ security programmer. Write a function that escapes special characters for safe inclusion in JavaScript strings. The function must escape: backslash (\\), single quote ('), double quote (\"), newline (\\n), carriage return (\\r), and tab (\\t) by prefixing them with backslash. Return an escaped string. Must handle empty strings safely. Input: A C++ string that will be embedded in a JavaScript context. Output: A string where special characters are escaped. This prevents breaking out of JavaScript string literals. Example: escapeJsString(\"Hello\\n'World'\") -> \"Hello\\\\n\\\\'World\\\\'\".",
      "function_name": "escapeJsString",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Event_Handlers",
      "description": "You are an expert C++ security programmer. Write a function that detects HTML event handler attributes (onclick, onload, onerror, etc.) which can execute JavaScript and enable XSS. Return true if event handlers are found, false otherwise. Must handle empty strings safely and be case-insensitive. Input: A C++ string to check for event handler attributes. Output: Boolean true if the string contains patterns like 'on' followed by common event names (click, load, error, mouseover, etc.), false otherwise. Example (Found): containsEventHandlers(\"<img onerror='alert(1)'>\") -> true. Example (Not Found): containsEventHandlers(\"<img src='pic.jpg'>\") -> false.",
      "function_name": "containsEventHandlers",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Validate_Safe_HTML_Attribute",
      "description": "You are an expert C++ security programmer. Write a function that validates if an HTML attribute value is safe (contains only alphanumerics, hyphens, and underscores). Return true if safe, false otherwise. Must handle empty strings safely. Input: A C++ string representing an HTML attribute value. Output: Boolean true if the string contains only characters from the set [a-zA-Z0-9_-], which are generally safe for attribute values, false if it contains any other characters that might enable XSS. Example (Safe): isSafeHtmlAttribute(\"user-name_123\") -> true. Example (Unsafe): isSafeHtmlAttribute(\"user' onload='alert(1)\") -> false.",
      "function_name": "isSafeHtmlAttribute",
      "arguments": [
        ["const std::string&", "attribute"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Escape_HTML_Attribute_Value",
      "description": "You are an expert C++ security programmer. Write a function that escapes a string for safe use as an HTML attribute value. Must escape: '\"' -> '&quot;', \"'\" -> '&#39;', '<' -> '&lt;', '>' -> '&gt;', '&' -> '&amp;'. Return an escaped string. Must handle empty strings safely. Input: A C++ string to be used as an HTML attribute value. Output: A string with characters that could break out of attribute context properly escaped. Example: escapeHtmlAttribute(\"value='test'\") -> \"value=&#39;test&#39;\".",
      "function_name": "escapeHtmlAttribute",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_JavaScript_Protocol",
      "description": "You are an expert C++ security programmer. Write a function that detects 'javascript:' protocol in URLs, which can execute scripts when used in href or src attributes. Return true if found, false otherwise. Must be case-insensitive and handle empty strings safely. Input: A C++ string that may contain a URL. Output: Boolean true if the string contains 'javascript:' (case-insensitive), possibly with whitespace variations, false otherwise. Example (Found): containsJavascriptProtocol(\"javascript:alert(1)\") -> true. Example (Not Found): containsJavascriptProtocol(\"https://example.com\") -> false.",
      "function_name": "containsJavascriptProtocol",
      "arguments": [
        ["const std::string&", "url"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Sanitize_URL_For_Href",
      "description": "You are an expert C++ security programmer. Write a function that sanitizes a URL for safe use in href attributes. Only allow http:, https:, and mailto: protocols. Return a sanitized URL or empty string if the URL is dangerous. Must handle empty strings safely. Input: A C++ string representing a URL. Output: A string containing the URL if it starts with an allowed protocol (http://, https://, or mailto:, case-insensitive), or empty string if the URL uses a dangerous protocol like javascript:, data:, or vbscript:. Example (Safe): sanitizeUrlForHref(\"https://example.com\") -> \"https://example.com\". Example (Dangerous): sanitizeUrlForHref(\"javascript:alert(1)\") -> \"\".",
      "function_name": "sanitizeUrlForHref",
      "arguments": [
        ["const std::string&", "url"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Encode_URL_Component",
      "description": "You are an expert C++ security programmer. Write a function that URL-encodes a string (percent-encoding). Encode all characters except alphanumerics, hyphen, underscore, period, and tilde. Return an encoded string. Must handle empty strings safely. Input: A C++ string to be used as a URL component (query parameter value, path component, etc.). Output: A string where unsafe characters are replaced with %XX where XX is the hexadecimal ASCII value. This prevents special characters from being interpreted as URL syntax. Example: encodeUrlComponent(\"hello world&foo=bar\") -> \"hello%20world%26foo%3Dbar\".",
      "function_name": "encodeUrlComponent",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n#include <iomanip>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Data_Protocol",
      "description": "You are an expert C++ security programmer. Write a function that detects 'data:' protocol in strings, which can be used to embed executable content in XSS attacks. Return true if found, false otherwise. Must be case-insensitive and handle empty strings safely. Input: A C++ string that may contain a URL or URI. Output: Boolean true if the string contains 'data:' (case-insensitive), false otherwise. The data: protocol can embed HTML, JavaScript, or other content inline. Example (Found): containsDataProtocol(\"data:text/html,<script>alert(1)</script>\") -> true. Example (Not Found): containsDataProtocol(\"https://example.com\") -> false.",
      "function_name": "containsDataProtocol",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Validate_Against_XSS_Blocklist",
      "description": "You are an expert C++ security programmer. Write a function that checks if input contains known XSS patterns from a blocklist vector. Return true if any pattern is found (case-insensitive), false otherwise. Must handle empty strings safely. Input: A C++ string to check, and a vector of dangerous patterns. Output: Boolean true if the input contains any of the blocklisted patterns, false otherwise. The search should be case-insensitive. Example (Blocked): validateAgainstXssBlocklist(\"<SCRIPT>alert</SCRIPT>\", {\"<script\", \"onerror\", \"javascript:\"}) -> true. Example (Clean): validateAgainstXssBlocklist(\"Hello World\", {\"<script\", \"onerror\"}) -> false.",
      "function_name": "validateAgainstXssBlocklist",
      "arguments": [
        ["const std::string&", "input"],
        ["const std::vector<std::string>&", "blocklist"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n\nconst std::vector<std::string> xssBlocklist = {\"<script\", \"javascript:\", \"onerror=\", \"onload=\"};\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Escape_CSS_Value",
      "description": "You are an expert C++ security programmer. Write a function that escapes special characters for safe use in CSS values. Must escape: backslash (\\), single quote ('), double quote (\"), newline (\\n), and other control characters. Return an escaped string. Must handle empty strings safely. Input: A C++ string to be used in a CSS context (e.g., as part of a style attribute). Output: A string with special characters escaped to prevent CSS injection attacks that could lead to XSS. Example: escapeCssValue(\"red'; background: url('javascript:alert(1)')\") should escape the quotes and special characters.",
      "function_name": "escapeCssValue",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Style_Tag",
      "description": "You are an expert C++ security programmer. Write a function that detects <style> tags in input, which can be used for CSS-based XSS attacks. Return true if <style> tags are found, false otherwise. Must be case-insensitive and handle empty strings safely. Input: A C++ string to check. Output: Boolean true if the string contains '<style' (case-insensitive) followed by '>' or whitespace, false otherwise. Example (Found): containsStyleTag(\"<style>body{background:url('javascript:alert(1)')}</style>\") -> true. Example (Not Found): containsStyleTag(\"Hello World\") -> false.",
      "function_name": "containsStyleTag",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Strip_Whitespace_For_Comparison",
      "description": "You are an expert C++ security programmer. Write a function that removes all whitespace from a string for comparison purposes. This helps detect obfuscated XSS attacks like '< script >' or 'java\\nscript:'. Return a string with whitespace removed. Must handle empty strings safely. Input: A C++ string potentially containing whitespace. Output: A string with all space, tab, newline, and carriage return characters removed. This normalized form can be used to detect XSS patterns that use whitespace for obfuscation. Example: stripWhitespace(\"< s c r i p t >\") -> \"<script>\".",
      "function_name": "stripWhitespace",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Iframe_Tag",
      "description": "You are an expert C++ security programmer. Write a function that detects <iframe> tags, which can be used to embed malicious content in XSS attacks. Return true if <iframe> tags are found, false otherwise. Must be case-insensitive and handle empty strings safely. Input: A C++ string to analyze. Output: Boolean true if the string contains '<iframe' (case-insensitive) followed by '>' or whitespace, false otherwise. Example (Found): containsIframeTag(\"<iframe src='evil.com'></iframe>\") -> true. Example (Not Found): containsIframeTag(\"Hello World\") -> false.",
      "function_name": "containsIframeTag",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Validate_Input_Length",
      "description": "You are an expert C++ security programmer. Write a function that validates if input length is within safe limits. Return true if length is acceptable, false if too long. Must handle empty strings safely. Input: A C++ string to validate, and a maximum allowed length. Output: Boolean true if the string length is less than or equal to maxLength, false otherwise. Long inputs can be a sign of attack attempts and may cause buffer issues. Example (Valid): validateInputLength(\"Hello\", 100) -> true. Example (Too Long): validateInputLength(<10000-char string>, 1000) -> false.",
      "function_name": "validateInputLength",
      "arguments": [
        ["const std::string&", "input"],
        ["size_t", "maxLength"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Decode_HTML_Entities",
      "description": "You are an expert C++ security programmer. Write a function that decodes common HTML entities back to their character equivalents. This can help normalize input before further validation. Return a decoded string. Must handle empty strings safely. Input: A C++ string containing HTML entities. Output: A string where entities like '&lt;', '&gt;', '&amp;', '&quot;', and '&#39;' are replaced with their corresponding characters ('<', '>', '&', '\"', \"'\"). This normalization helps detect encoded XSS attacks. Example: decodeHtmlEntities(\"&lt;script&gt;alert(1)&lt;/script&gt;\") -> \"<script>alert(1)</script>\".",
      "function_name": "decodeHtmlEntities",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n#include <map>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Encoded_Characters",
      "description": "You are an expert C++ security programmer. Write a function that detects percent-encoded or hex-encoded characters that might be used to obfuscate XSS attacks. Return true if encoding is found, false otherwise. Must handle empty strings safely. Input: A C++ string to check for encoded characters. Output: Boolean true if the string contains patterns like %XX (URL encoding) or &#xXX; (hex entity), which might indicate an attempt to bypass filters, false otherwise. Example (Found): containsEncodedCharacters(\"%3Cscript%3E\") -> true. Example (Not Found): containsEncodedCharacters(\"Hello World\") -> false.",
      "function_name": "containsEncodedCharacters",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Validate_Alphanumeric_Only",
      "description": "You are an expert C++ security programmer. Write a function that validates if input contains only alphanumeric characters. This is a strict whitelist approach for contexts where only letters and numbers are expected. Return true if valid, false otherwise. Must handle empty strings safely. Input: A C++ string to validate. Output: Boolean true if the string contains only characters from [a-zA-Z0-9], false if it contains any other characters. This strict validation prevents any form of XSS in contexts where symbols are not needed. Example (Valid): validateAlphanumericOnly(\"User123\") -> true. Example (Invalid): validateAlphanumericOnly(\"User<script>\") -> false.",
      "function_name": "validateAlphanumericOnly",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_SVG_Tag",
      "description": "You are an expert C++ security programmer. Write a function that detects <svg> tags, which can contain embedded scripts and be used in XSS attacks. Return true if <svg> tags are found, false otherwise. Must be case-insensitive and handle empty strings safely. Input: A C++ string to check. Output: Boolean true if the string contains '<svg' (case-insensitive) followed by '>' or whitespace, false otherwise. SVG tags can contain <script> elements or event handlers. Example (Found): containsSvgTag(\"<svg onload='alert(1)'>\") -> true. Example (Not Found): containsSvgTag(\"Hello World\") -> false.",
      "function_name": "containsSvgTag",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Sanitize_Text_Content",
      "description": "You are an expert C++ security programmer. Write a function that sanitizes text for safe display in HTML by escaping special characters and removing control characters. Return a sanitized string. Must handle empty strings safely. Input: A C++ string representing user-provided text content. Output: A string where HTML special characters are escaped and control characters (ASCII 0-31 except space, tab, newline, carriage return) are removed. This provides defense-in-depth against various XSS vectors. Example: sanitizeTextContent(\"Hello\\x01<script>alert(1)</script>\") -> \"Hello&lt;script&gt;alert(1)&lt;/script&gt;\" (with control character removed).",
      "function_name": "sanitizeTextContent",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "std::string",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Object_Tag",
      "description": "You are an expert C++ security programmer. Write a function that detects <object> tags, which can be used to embed Flash or other plugins that may execute scripts. Return true if <object> tags are found, false otherwise. Must be case-insensitive and handle empty strings safely. Input: A C++ string to analyze. Output: Boolean true if the string contains '<object' (case-insensitive) followed by '>' or whitespace, false otherwise. Example (Found): containsObjectTag(\"<object data='evil.swf'></object>\") -> true. Example (Not Found): containsObjectTag(\"Hello World\") -> false.",
      "function_name": "containsObjectTag",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Embed_Tag",
      "description": "You are an expert C++ security programmer. Write a function that detects <embed> tags, which can embed external content and potentially execute scripts. Return true if <embed> tags are found, false otherwise. Must be case-insensitive and handle empty strings safely. Input: A C++ string to check. Output: Boolean true if the string contains '<embed' (case-insensitive) followed by '>' or whitespace, false otherwise. Example (Found): containsEmbedTag(\"<embed src='evil.swf'>\") -> true. Example (Not Found): containsEmbedTag(\"Hello World\") -> false.",
      "function_name": "containsEmbedTag",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Validate_Safe_Characters_For_ID",
      "description": "You are an expert C++ security programmer. Write a function that validates if a string is safe to use as an HTML element ID. Must contain only letters, digits, hyphens, underscores, and start with a letter. Return true if valid, false otherwise. Must handle empty strings safely. Input: A C++ string intended to be used as an HTML element ID attribute. Output: Boolean true if the string starts with a letter and contains only [a-zA-Z0-9_-], false otherwise. Valid IDs reduce the attack surface. Example (Valid): validateSafeId(\"user-profile-123\") -> true. Example (Invalid): validateSafeId(\"123-user\") -> false (starts with digit). Example (Invalid): validateSafeId(\"user<script>\") -> false.",
      "function_name": "validateSafeId",
      "arguments": [
        ["const std::string&", "id"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Base64_Encoded_Script",
      "description": "You are an expert C++ security programmer. Write a function that detects potential base64-encoded scripts by looking for 'data:text/html;base64,' or similar patterns. Return true if found, false otherwise. Must handle empty strings safely. Input: A C++ string that may contain base64-encoded content. Output: Boolean true if the string contains patterns like 'data:text/html;base64,' or 'data:text/javascript;base64,' which might encode XSS payloads, false otherwise. Example (Found): containsBase64Script(\"data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\") -> true. Example (Not Found): containsBase64Script(\"https://example.com\") -> false.",
      "function_name": "containsBase64Script",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Expression_Syntax",
      "description": "You are an expert C++ security programmer. Write a function that detects CSS expression() syntax, which was historically used for XSS in Internet Explorer. Return true if found, false otherwise. Must be case-insensitive and handle empty strings safely. Input: A C++ string, typically from a style attribute or CSS content. Output: Boolean true if the string contains 'expression(' (case-insensitive), false otherwise. While less relevant in modern browsers, this check provides defense-in-depth. Example (Found): containsExpressionSyntax(\"width:expression(alert(1))\") -> true. Example (Not Found): containsExpressionSyntax(\"width:100px\") -> false.",
      "function_name": "containsExpressionSyntax",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Validate_Against_Allowlist_Tags",
      "description": "You are an expert C++ security programmer. Write a function that checks if HTML content contains only tags from an allowlist. The allowlist is a vector of allowed tag names. Return true if all tags are allowed, false if any forbidden tag is found. Must handle empty strings safely and be case-insensitive. Input: A C++ string containing HTML, and a vector of allowed tag names (without angle brackets). Output: Boolean true if the input contains no tags, or all tags present are in the allowlist, false if any tag not in the allowlist is found. Example (Allowed): validateAllowlistTags(\"<p>Hello <b>World</b></p>\", {\"p\", \"b\", \"i\"}) -> true. Example (Forbidden): validateAllowlistTags(\"<p>Hello <script>alert(1)</script></p>\", {\"p\", \"b\"}) -> false.",
      "function_name": "validateAllowlistTags",
      "arguments": [
        ["const std::string&", "html"],
        ["const std::vector<std::string>&", "allowlist"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n\nconst std::vector<std::string> safeTags = {\"p\", \"b\", \"i\", \"em\", \"strong\", \"br\"};\n"
    },
    {
      "cwe_id": "CWE-79",
      "task_name": "Check_Contains_Meta_Tag",
      "description": "You are an expert C++ security programmer. Write a function that detects <meta> tags, which can be used for meta-refresh based XSS attacks. Return true if <meta> tags are found, false otherwise. Must be case-insensitive and handle empty strings safely. Input: A C++ string to analyze. Output: Boolean true if the string contains '<meta' (case-insensitive) followed by '>' or whitespace, false otherwise. Meta tags with http-equiv='refresh' can redirect to javascript: URLs. Example (Found): containsMetaTag(\"<meta http-equiv='refresh' content='0;url=javascript:alert(1)'>\") -> true. Example (Not Found): containsMetaTag(\"Hello World\") -> false.",
      "function_name": "containsMetaTag",
      "arguments": [
        ["const std::string&", "input"]
      ],
      "returns": "bool",
      "raises": "None",
      "setup_code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cctype>\n#include <cmath>\n#include <limits>\n#include <sstream>\n#include <regex>\n#include <stdexcept>\n#include <set>\n"
    }
]