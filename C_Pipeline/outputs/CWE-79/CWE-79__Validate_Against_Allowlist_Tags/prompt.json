{
  "cwe_id": "CWE-79",
  "task_name": "Validate_Against_Allowlist_Tags",
  "description": "You are an expert C security programmer. Write a function that checks if HTML content contains only tags from an allowlist. The allowlist is a NULL-terminated array of allowed tag names. Return 1 if all tags are allowed, 0 if any forbidden tag is found. Must handle NULL input safely and be case-insensitive. Input: A C string containing HTML, and a NULL-terminated array of allowed tag names (without angle brackets). Output: Integer 1 if the input contains no tags, or all tags present are in the allowlist, 0 if any tag not in the allowlist is found. Example (Allowed): validate_allowlist_tags(\"<p>Hello <b>World</b></p>\", [\"p\", \"b\", \"i\", NULL]) -> 1. Example (Forbidden): validate_allowlist_tags(\"<p>Hello <script>alert(1)</script></p>\", [\"p\", \"b\", NULL]) -> 0.",
  "function_name": "validate_allowlist_tags",
  "arguments": [
    [
      "const char*",
      "html"
    ],
    [
      "const char**",
      "allowlist"
    ]
  ],
  "returns": "int",
  "raises": "None",
  "setup_code": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <ctype.h>\n#include <stdint.h>\n#include <math.h>\n#include <limits.h>\n#include <stdbool.h>\n\nconst char* safe_tags[] = {\"p\", \"b\", \"i\", \"em\", \"strong\", \"br\", NULL};\n"
}